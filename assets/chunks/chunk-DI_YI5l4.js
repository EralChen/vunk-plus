import{d as c,D,i as b,aq as q,c as C,ar as w,as as P,L as N,P as h,G as Y,E as x}from"./chunk-C-sTROv_.js";const i="vkStrategyRenderer";function B(e){return`${e}__data`}function G(e,n,t=i){const s=C(()=>e.data),p={data:s,emitSetData:u=>{n.emit("setData",{intoUndefined:P,...u})},getDataValue:u=>w(s.value,u,P,!0)};return h(B(t),p),p}function S(e=i){const n=`${e}__data`;return b(n,{})}const A=Symbol("PARENT_KEY");function K(e){return`${e}__templateInstances`}function m(e=i){return b(K(e),null)}function L(e=i){const n=m(e),t=q({});return t[A]=n,h(K(e),t),t}function z(e=i){const n=m(e),t=a=>a?.[A];return{templateInstances:n,getTemplateInstance:a=>{let o=n?.[a];if(o)return o;let p=t(n);for(;p;){if(o=p?.[a],o)return o;p=t(p)}return null},getParent:t}}function _(e){return c({setup(n,{slots:t}){const s=m(e),a=L(e);return s?()=>t.default?.({templateInstances:a}):()=>[t.placeholder?.(),t.default?.({templateInstances:a})]}})}function H(e){return e instanceof Function||typeof e=="function"}const J=e=>{if(typeof e=="boolean"){const n=e;return()=>n}else{if(typeof e=="string")return new Function("data",e);if(typeof e=="function")return e}return()=>!0},$={source:{type:Array,default:()=>[]},templateInstances:{type:Object,default:void 0},k:{type:Array,default:()=>[]}};function M(e){const n=c({props:$,inheritAttrs:!1,setup(t,s){const{templateInstances:a,getTemplateInstance:o}=z(e),{emitSetData:p,data:u,getDataValue:I}=S(e),k=d=>D(n,{templateInstances:a,...s.attrs,...d}),E=(d,j=[])=>d.reduce((f,r,F)=>{r.key=r.key??(Array.isArray(r.prop)?r.prop.join():r.prop);const R=[...t.k,...j,F],O=()=>{N(()=>{r.templateType&&!o(r.templateType)&&console.warn(r.templateType,"templateType不存在将跳过")})};if(r.templateType&&o(r.templateType)){const g=J(r.templateIf);if(!(u?g(u.value):!0))return f;const l={...r};Object.assign(l,H(r.templateProps)?r.templateProps(u?.value):r.templateProps),Reflect.deleteProperty(l,"templateType"),Reflect.deleteProperty(l,"templateIf"),Reflect.deleteProperty(l,"templateProps");const U=`${R.join(",")}-${r.templateType}-${r.prop||"no-prop"}`,V=C({get:()=>r.prop&&I?.(r.prop),set:T=>p?.({k:r.prop,v:T})}),v=o(r.templateType)?.slots.default?.({...s.attrs,raw:r,props:l,k:R,key:U,value:V.value,input:T=>V.value=T,templateIf:g,Renderer:k,getDataValue:I,emitSetData:p});v&&f.push(v)}else O();return f},[]);return()=>[s.slots.default?.(),E(t.source)]}});return n}function Q(e){const n=_(e),t=M(e);return c({props:$,inheritAttrs:!1,setup(s,{slots:a,attrs:o}){return()=>D(n,{},{default:()=>D(t,{...o,...s},a.default),placeholder:a.placeholder})}})}const W={data:{type:Object,default:()=>({})}},X={setData:e=>e};function Z(e){return c({props:W,emits:X,setup(n,{emit:t,slots:s}){const a=G(n,{emit:t},e);return()=>s.default?.(a)}})}const ee={type:{type:String,required:!0,default:""}};function te(e){return c({props:ee,setup(n){const t=m(e);if(!t)throw new Error("VkRendererTemplate must be used inside a VkRenderer");const s=Y(),a=t[n.type];return s&&t&&(t[n.type]=s),x(()=>{t[n.type]=a}),()=>null}})}function ne(e){return{Data:Z(e),Renderer:Q(e),Template:te(e),Templates:_(e),useData:()=>S(e)}}const{Data:se,Renderer:oe,Template:y,Templates:pe}=ne();y.install=e=>{e.component(y.name||"VkRendererTemplate",y)};export{y as V,se as a,oe as b,pe as c};
