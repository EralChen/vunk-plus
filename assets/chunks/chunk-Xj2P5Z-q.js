import{s as x}from"./chunk-CLfTKXP-.js";import{c as E}from"./chunk-DucCsfaH.js";import{R as V}from"./chunk-23AHP9H5.js";import{k as a,r as b,aQ as S,d as $,j as P}from"./chunk-WaRpenU8.js";import{I as T,E as H}from"./chunk-CGIe-Bk9.js";/* empty css              */var N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92a95.8 95.8 0 01-52-15l-54 55c29.1 22.4 65.9 36 106 36 93.8 0 170-75.1 170-168z"}},{tag:"path",attrs:{d:"M833 446h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254-63 0-120.7-23-165-61l-54 54a334.01 334.01 0 00179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328 0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9a8 8 0 00-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68A252.33 252.33 0 01258 454c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8 0 53 12.5 103 34.6 147.4l-137 137a8.03 8.03 0 000 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92 46 0 84.1 32.3 92.3 74.7L417 401z"}}]},name:"audio-muted",theme:"outlined"};function A(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable}))),r.forEach(function(o){j(t,o,n[o])})}return t}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(e,n){var r=A({},e,n.attrs);return a(T,A({},r,{icon:N}),null)};y.displayName="AudioMutedOutlined";y.inheritAttrs=!1;var B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1zM512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168zm-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92V232z"}}]},name:"audio",theme:"outlined"};function C(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable}))),r.forEach(function(o){z(t,o,n[o])})}return t}function z(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=function(e,n){var r=C({},e,n.attrs);return a(T,C({},r,{icon:B}),null)};_.displayName="AudioOutlined";_.inheritAttrs=!1;function D(){const t=b(!1),e=b(!1),n=b(!1),r=new V({type:"wav",sampleRate:16e3,bitRate:16});function o(){return n.value=!0,new Promise((c,h)=>{r.open(()=>{t.value=!0,n.value=!1,E.info("recorder open success",r),c(r)},()=>(u,k)=>{t.value=!1,S.error(`${k?"用户未授权, ":""}无法录音:${u}`),h(u)})})}function l(){return r.start(),e.value=!0,r}function v(){return new Promise((c,h)=>{r.stop(u=>{r.close(),e.value=!1,c(u)},u=>{S.error("录音失败"),console.error(u),r.close(),e.value=!1,h(u)})})}async function g(){return t.value?o().then(l):Promise.race([o(),x(1500)]).then(c=>{if(c)return l()})}return{supported:t,recording:e,opening:n,recorder:r,open:o,stop:v,start:l,openOrStart:g}}const L={disabled:{type:Boolean,default:!1}},X={stop:t=>!0,start:null},s=1e3,U=50,O=200,G=$({name:"AXSenderLoadingIcon",setup(){return()=>a("svg",{color:"currentColor",viewBox:`0 0 ${s} ${s}`,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},[a("title",null,[P("Speech Loading")]),a("circle",{cx:s/2,cy:s/2,r:O,fill:"none",stroke:"currentColor","stroke-width":U,"stroke-linecap":"round","stroke-dasharray":`${Math.PI*O*.75} ${Math.PI*O*.25}`},[a("animateTransform",{attributeName:"transform",type:"rotate",from:`0 ${s/2} ${s/2}`,to:`360 ${s/2} ${s/2}`,dur:"1s",repeatCount:"indefinite"},null)])])}}),i=1e3,f=4,m=140,I=m/2,d=250,R=500,p=.8,M=$({name:"AXSenderRecordingIcon",setup(){return()=>a("svg",{color:"currentColor",viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},[a("title",null,[P("Speech Recording")]),Array.from({length:f}).map((t,e)=>{const n=(i-m*f)/(f-1),r=e*(n+m),o=i/2-d/2,l=i/2-R/2;return a("rect",{fill:"currentColor",rx:I,ry:I,height:d,width:m,x:r,y:o,key:e},[a("animate",{attributeName:"height",values:`${d}; ${R}; ${d}`,keyTimes:"0; 0.5; 1",dur:`${p}s`,begin:`${p/f*e}s`,repeatCount:"indefinite"},null),a("animate",{attributeName:"y",values:`${o}; ${l}; ${o}`,keyTimes:"0; 0.5; 1",dur:`${p}s`,begin:`${p/f*e}s`,repeatCount:"indefinite"},null)])})])}}),w=$({name:"VkSpeechButton",components:{RecordingIcon:M},props:L,emits:X,setup(t,{emit:e}){const{openOrStart:n,recording:r,stop:o,opening:l}=D(),v=()=>{t.disabled||l.value||(r.value?o().then(c=>{e("stop",c)}):n().then(c=>{c&&e("start")}))},g=()=>t.disabled?a(y,null,null):l.value?a(G,null,null):r.value?a(M,{class:"vk-speech-button-recording-icon"},null):a(_,null,null);return()=>a(H,{onClick:v,class:"vk-speech-button"},{icon:g})}});w.install=t=>{t.component(w.name||"VkSpeechButton",w)};export{w as _};
