<!DOCTYPE html>
    <html lang="zh-CN">
      <head>
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/onCreateApp.DdGbM3vl.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_layouts_default_aside-6ea01de8.BjbON5Ij.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_layouts_default_navbar-403af73f.u3IytZI2.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/pages_uno-88a4f3d7.DXhbHvT1.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_common_reset-f7a68b0e.BAKp5MHC.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_common_color-a7a524c7.CVau4Kly.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_common_is-19c6c24d.DKAKruk7.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-6912e642.BV4wSeDz.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-828a286c.Beul3IQx.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_reset-752cc03d.htEpr2M-.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_form-item-877afd6a.Dy4HJB2K.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_table-6cbc5816.DXG1SsxY.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_tabs-67d1a98b.BMDMQPDv.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_tree-cc28503d.nmT5n0wM.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_dialog-7f91a00e.D4nTsJge.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_breadcrumb-8ce3a1a1.CwEEGJYc.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_element-plus_menu-33b44202.hFAFO4eV.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-5918c0d5.DKHZNGtr.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-e2956485.BBK-T9RK.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-3ec25e25.Cc2PI5FU.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_form_sub-7371c85e.y3zh-mS3.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_layout_index-2891f17b.BNCqvENj.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-3bd3911a.CRScSR0a.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-6204a234.BZwgKm1s.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-55703ee6.CFNWXuiE.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-512eb9e9.X9gIGpBH.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-744b2847.Di2LGzYR.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-f00a3d20.C8H6Fcyw.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_markdown_reset-fbd16bdd.D3vNaEcf.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_styles_markdown_shiki-0d2326df.uut6VZYd.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/style-83c4ec74.wrHlRtLn.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_layouts_default_index-a6f52725.DkwwbNdY.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_layouts_default_index-faa86ca4.DrA58BD7.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/src_layouts_default_index-ae92d183.CQLOEbHd.css">
        <link rel="stylesheet" type="text/css" href="/vunk-plus/assets/static/pages_uno-88a4f3d7.CiPwcwD_.css">
        <meta charset="UTF-8" />
        
    <title>AgentChatProvider</title><meta property="og:title" content="AgentChatProvider">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[--><!--]-->
    
    
    
  
      </head>
      <body>
        
        <div id="app"><div class="vk-duplex layout-default" style="--vk-duplex-overflow:hidden;--vk-duplex-flex:1;--vk-duplex-direction:column;--vk-duplex-gap:0;"><div class="vk-duplex-1 with-overflow"><!--[--><div class="layout-default-header"><div sk-flex="row-between-center" class="h-full layout-default-navbar"><div class="font-600 plr-l ptb-s text-primary"> @vunk/plus </div><div sk-flex="row_center" sub:gml-s><ul role="menubar" style="--el-menu-level:0;" class="el-menu el-menu--horizontal"><!--[--><!--[--><!--[--><li class="el-menu-item" role="menuitem" tabindex="-1"><!--[--><!--[--><!--[--><!--[--><!--[--><a href="/vunk-plus/zh-CN/guide/introduction" class="layout-default-nav-menu-a" title="指南"></a><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><!--[--><!--[--><span class="layout-default-nav-menu-title">指南</span><!--]--><!--]--><!--]--><!--]--><!--]--></li><!--]--><!--]--><!--[--><!--[--><li class="el-menu-item" role="menuitem" tabindex="-1"><!--[--><!--[--><!--[--><!--[--><!--[--><a href="/vunk-plus/zh-CN/component/tables-v1" class="layout-default-nav-menu-a" title="组件"></a><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><!--[--><!--[--><span class="layout-default-nav-menu-title">组件</span><!--]--><!--]--><!--]--><!--]--><!--]--></li><!--]--><!--]--><!--]--></ul><div class="theme-toggler-content" data-v-47d0f47c><div aria-label="theme-toggler" aria-checked="false" data-v-47d0f47c data-v-eebe66d4><!----></div></div></div></div></div><!--]--></div><div class="vk-duplex-2 with-flex with-overflow"><!--[--><!--]--><!--[--><div sk-flex class="h-100% relative"><div class="layout-default-aside-x bg-bg-base"><div class="vk-duplex layout-default-aside" style="--vk-duplex-overflow:hidden;--vk-duplex-flex:1;--vk-duplex-direction:column;--vk-duplex-gap:var(--gap-m);"><div class="vk-duplex-1 with-overflow"><!--[--><div class="page-agent-main-top-options" sk-flex="row-between-center" mlr-m mt-m><!--[--><i class="el-icon cursor-pointer el-tooltip__trigger el-tooltip__trigger" style="font-size:24px;"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M896 192H128v128h768zm0 256H384v128h512zm0 256H128v128h768zM320 384 128 512l192 128z"></path></svg><!--]--></i><!--[--><!--v-if--><!--]--><!--]--><!--[--><i class="el-icon cursor-pointer el-tooltip__trigger el-tooltip__trigger" style="font-size:22px;"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"></path></svg><!--]--></i><!--[--><!--v-if--><!--]--><!--]--></div><!--]--></div><div class="vk-duplex-2 with-flex with-overflow"><!--[--><!--]--><!--[--><div class="vk-duplex h-full" style="--vk-duplex-overflow:hidden;--vk-duplex-flex:1;--vk-duplex-direction:column;--vk-duplex-gap:0;"><div class="vk-duplex-1 with-overflow"><!--[--><div class="el-input el-input--large layout-default-aside-search" style="display:none;"><!-- input --><!--[--><!-- prepend slot --><!--v-if--><div class="el-input__wrapper"><!-- prefix slot --><!--v-if--><input class="el-input__inner" type="text" autocomplete="off" tabindex="0" placeholder="搜索组件" style="" form><!-- suffix slot --><!--v-if--></div><!-- append slot --><!--v-if--><!--]--></div><!--]--></div><div class="vk-duplex-2 with-flex with-overflow"><!--[--><div class="el-scrollbar"><div class="el-scrollbar__wrap el-scrollbar__wrap--hidden-default" style=""><div class="el-scrollbar__view" style=""><!--[--><ul role="menubar" style="--el-menu-level:0;" class="el-menu el-menu--vertical layout-default-aside-menu"><!--[--><!--]--></ul><!--]--></div></div><!--[--><div class="el-scrollbar__bar is-horizontal" style="display:none;"><div class="el-scrollbar__thumb" style="width:;transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical" style="display:none;"><div class="el-scrollbar__thumb" style="height:;transform:translateY(0%);"></div></div><!--]--></div><!--]--><!--[--><!--]--></div></div><!--]--></div></div></div><div class="vk-duplex flex-1 overflow-hidden" style="--vk-duplex-overflow:hidden;--vk-duplex-flex:1;--vk-duplex-direction:column;--vk-duplex-gap:0;"><div class="vk-duplex-1 with-overflow"><!--[--><!--]--></div><div class="vk-duplex-2 with-flex with-overflow"><!--[--><!--]--><!--[--><div class="el-scrollbar"><div class="el-scrollbar__wrap el-scrollbar__wrap--hidden-default" style=""><div id="VPScrollView" class="el-scrollbar__view" style=""><!--[--><main class="page-content"><div position-absolute pt-m pl-m style="display:none;"><i class="el-icon cursor-pointer" style="font-size:24px;"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M128 192h768v128H128zm0 256h512v128H128zm0 256h768v128H128zm576-352 192 160-192 128z"></path></svg><!--]--></i></div><div class="doc-content-wrapper"><div id="VPContent" class="doc-content-container"><!--[--><div class="vp-doc VPDoc doc-content"><h1 id="agentchatprovider" tabindex="-1">AgentChatProvider <a class="header-anchor" href="#agentchatprovider" aria-label="Permalink to &quot;AgentChatProvider&quot;">​</a></h1><p>AgentChatProvider 是一个对话代理提供者组件，用于处理聊天消息的请求、响应和状态管理。它支持流式响应处理、思考状态显示和多种角色支持。</p><p>你可以查阅以下链接了解抽象数据流的工作细节:</p><p><a href="https://x.ant.design/components/use-x-agent-cn" target="_blank" rel="noreferrer">useXAgent</a></p><p><a href="https://x.ant.design/components/use-x-chat-cn" target="_blank" rel="noreferrer">useXChat</a></p><h2 id="基本用法" tabindex="-1">基本用法 <a class="header-anchor" href="#基本用法" aria-label="Permalink to &quot;基本用法&quot;">​</a></h2><p>使用 AgentChatProvider 包裹聊天相关组件，为其提供上下文能力：</p><div class="language-vue"><button class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkAgentChatProvider</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    :request</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;request&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    :parser</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;parser&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    @load</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;agentChatContext.resolve&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  &gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkChatIndependent</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      :data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;bubbleData&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      :speech-to-text</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;speechToTextFn&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      :text-to-speech</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;textToSpeechFn&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      @set-data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;setData(bubbleData, $event)&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    /&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  &lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span></code></pre></div><h2 id="props" tabindex="-1">Props <a class="header-anchor" href="#props" aria-label="Permalink to &quot;Props&quot;">​</a></h2><table><thead><tr><th>prop</th><th>type</th><th>default</th><th>description</th></tr></thead><tbody><tr><td>request</td><td><code>Function</code></td><td>内置默认函数</td><td>请求处理函数，用于处理聊天消息的发送和接收</td></tr><tr><td>parser</td><td><code>Function</code></td><td>内置默认函数</td><td>消息解析函数，用于解析和转换接收到的消息</td></tr></tbody></table><h2 id="events" tabindex="-1">Events <a class="header-anchor" href="#events" aria-label="Permalink to &quot;Events&quot;">​</a></h2><table><thead><tr><th>name</th><th>arguments</th><th>description</th></tr></thead><tbody><tr><td>load</td><td><code>(context: AgentChatContext)</code></td><td>组件加载完成时触发，返回代理聊天上下文</td></tr></tbody></table><h2 id="内置角色类型" tabindex="-1">内置角色类型 <a class="header-anchor" href="#内置角色类型" aria-label="Permalink to &quot;内置角色类型&quot;">​</a></h2><p>组件支持三种角色类型：</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> enum</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Role</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  User</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;user&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 用户角色</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  Assistant</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;assistant&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 助手角色</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  Broadcasting</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;broadcasting&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 播报角色</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div><h2 id="提供的能力" tabindex="-1">提供的能力 <a class="header-anchor" href="#提供的能力" aria-label="Permalink to &quot;提供的能力&quot;">​</a></h2><p>组件通过 Vue 的 provide/inject 机制提供以下上下文：</p><h3 id="使用方式" tabindex="-1">使用方式 <a class="header-anchor" href="#使用方式" aria-label="Permalink to &quot;使用方式&quot;">​</a></h3><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { useAgentChat } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/agent-chat-provider&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 在子组件中获取上下文</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">agent</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">chat</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">simplicity</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useAgentChat</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span></code></pre></div><h3 id="上下文内容" tabindex="-1">上下文内容 <a class="header-anchor" href="#上下文内容" aria-label="Permalink to &quot;上下文内容&quot;">​</a></h3><ul><li><code>agent</code>: 代理实例，提供消息管理相关功能</li><li><code>chat</code>: 聊天实例，提供消息解析和处理功能</li><li><code>simplicity</code>: 简化的接口 <ul><li><code>onRequest(message: string)</code>: 发送消息</li><li><code>items</code>: 聊天消息列表（计算属性）</li></ul></li></ul><h2 id="自定义请求处理" tabindex="-1">自定义请求处理 <a class="header-anchor" href="#自定义请求处理" aria-label="Permalink to &quot;自定义请求处理&quot;">​</a></h2><p>可以通过自定义 <code>request</code> 属性来实现自定义请求处理逻辑：</p><h3 id="基本示例" tabindex="-1">基本示例 <a class="header-anchor" href="#基本示例" aria-label="Permalink to &quot;基本示例&quot;">​</a></h3><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> request</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> __VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Request</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">info</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">event</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">message</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> info</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">onSuccess</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">onUpdate</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> event</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 处理消息发送</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 使用 onUpdate 更新消息状态</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 使用 onSuccess 标记消息发送成功</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div><details class="details custom-block"><summary>完整实现示例</summary><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 自定义请求函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">async</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> agentRequest</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  onmessage</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> RestFetchReaderOnmessage</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  data</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">    message</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">    chatId</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> restFetch.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">reader</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    url: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">`/application/chat_message/${</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">data</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">.</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">chatId</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">}`</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    onmessage,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }, {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    headers: {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      authorization: localStorage.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">getItem</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;accessToken&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">),</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    data: {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      message: data.message,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 组合成请求处理器</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useRequest</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> () {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">id</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">applicationId</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useApplicationProfile</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> chatId</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ref</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">string</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> ready</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ref</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">false</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 获取会话ID</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  cChatId</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    application_id: applicationId,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }).</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">then</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">id</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    chatId.value </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> id</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    ready.value </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> true</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 实现请求处理函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> request</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> __VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Request</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">info</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">event</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">message</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> info</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">onSuccess</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">onUpdate</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> event</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">!</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">message?.content) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // 初始化状态</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    let</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> content </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> role</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> Role.Broadcasting</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    let</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> thinkingContent </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    let</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> thinkingStatus</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> __VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">AgentMessage</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;thinkingStatus&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;start&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    let</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> seviceLoading </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // 更新状态的函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> update</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> () </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      onUpdate</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        role,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        content,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingContent,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingStatus,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        seviceLoading,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // 成功完成的函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> success</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> () </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      onSuccess</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        role,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        content,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingContent,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingStatus,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        seviceLoading,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        seviceEnd: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // 初始状态更新</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // 发送请求并处理流式响应</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    agentRequest</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">e</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> any</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      let</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> json </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        content: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        reasoning_content: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">typeof</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> e.data </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">===</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;string&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        json </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> JSON</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">parse</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(e.data)</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // 处理结束信号</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (json.is_end) {</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        success</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">        return</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // 处理思考内容</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (json.reasoning_content) {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingContent </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">+=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> json.reasoning_content</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingStatus </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;thinking&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        seviceLoading </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> false</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // 处理回复内容</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (json.content) {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        content </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">+=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> json.content</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        seviceLoading </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> false</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // 思考完成的判断</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (thinkingContent </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">&amp;&amp;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> json.content) {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        thinkingStatus </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;end&#39;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      }</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }, {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      message: message?.content,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      chatId: chatId.value</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    request,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    ready,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div></details><h2 id="自定义消息解析" tabindex="-1">自定义消息解析 <a class="header-anchor" href="#自定义消息解析" aria-label="Permalink to &quot;自定义消息解析&quot;">​</a></h2><p>可以通过自定义 <code>parser</code> 属性来实现自定义消息解析逻辑：</p><h3 id="基本示例-1" tabindex="-1">基本示例 <a class="header-anchor" href="#基本示例-1" aria-label="Permalink to &quot;基本示例&quot;">​</a></h3><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> parser</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> __VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Parser</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">message</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 解析消息并返回气泡消息列表</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      ...</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">message,</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // 可以添加额外属性</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  ]</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div><details class="details custom-block"><summary>完整实现示例</summary><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">type</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> __VkAgentChatProvider, Role } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/agent-chat-provider&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> const</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> parser</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> __VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Parser</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">message</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 主消息</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> list</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      ...</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">message,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      loading: message.seviceLoading,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // 当存在思考内容时，添加一个额外的提示消息</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (message.thinkingContent) {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    list.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">unshift</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      role: Role.Broadcasting,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      content: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;您好，请让我先思考一下这个问题，再给您回答&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      seviceLoading: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">false</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      seviceEnd: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      loading: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">false</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      meta: {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        metahumanStatus: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">2</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 设置背景状态</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> list</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div></details><p>这个示例展示了如何：</p><ol><li>处理消息的加载状态</li><li>在有思考内容时添加额外的提示消息</li><li>设置元数据和状态</li></ol><h2 id="思考状态处理" tabindex="-1">思考状态处理 <a class="header-anchor" href="#思考状态处理" aria-label="Permalink to &quot;思考状态处理&quot;">​</a></h2><p>组件支持显示思考状态，通过 <code>thinkingContent</code> 和 <code>thinkingStatus</code> 控制：</p><ul><li><code>thinkingStatus</code>: 思考状态 <ul><li><code>start</code>: 开始思考</li><li><code>thinking</code>: 思考中</li><li><code>end</code>: 思考结束</li><li><code>error</code>: 思考错误</li></ul></li><li><code>thinkingContent</code>: 思考内容</li></ul><h2 id="类型定义" tabindex="-1">类型定义 <a class="header-anchor" href="#类型定义" aria-label="Permalink to &quot;类型定义&quot;">​</a></h2><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 请求函数类型</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Request</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> RequestFn</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">AgentMessage</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 解析器类型</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Parser</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">message</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> AgentMessage</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> BubbleMessage</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> |</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> BubbleMessage</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">[]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 代理消息类型</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> AgentMessage</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> BubbleMessage</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> &amp;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  seviceLoading</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> boolean</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  seviceEnd</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> boolean</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 气泡消息类型</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">export</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> BubbleMessage</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Partial</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">BubbleListItemProps</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt; </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">&amp;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  role</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  content</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  seviceEnd</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> boolean</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  thinkingStatus</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;start&#39;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> |</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;thinking&#39;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> |</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;end&#39;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> |</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;error&#39;</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  thinkingContent</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  meta</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">?:</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> NormalObject</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></div><h2 id="完整用例" tabindex="-1">完整用例 <a class="header-anchor" href="#完整用例" aria-label="Permalink to &quot;完整用例&quot;">​</a></h2><p>下面展示一个完整的聊天应用实现，包含代理聊天提供者、独立聊天组件、语音转文本、文本转语音等功能：</p><div class="language-vue"><button class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff;" tabindex="0"><code v-pre><span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">script</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> lang</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;ts&quot;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> setup</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { __VkAgentChatProvider } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/agent-chat-provider&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> type</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { __VkBubbleList } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/bubble-list&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { speechToText, textToSpeech } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@/api/application&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { useApplicationProfile } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@/components/authentication&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { MetahumanBackground, MetahumanStatus } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@/components/metahuman-background&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { Role, VkAgentChatProvider } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/agent-chat-provider&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { VkChatIndependent } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk-plus/components/chat-independent&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { setData } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk/core&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { useDeferred } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;@vunk/core/composables&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { computed, ref, watchEffect } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { parser } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;./parser&#39;</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">import</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { useRequest } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">from</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &#39;./useRequest&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 获取应用配置</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  stt_model_enable</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 语音转文本是否启用</span></span>
<span class="line"><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">  id</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">applicationId</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  prologue</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 开场白</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">} </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useApplicationProfile</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 获取请求处理函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">ready</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">request</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> } </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useRequest</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">/* chat 数据 */</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> bubbleData</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ref</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">__VkBubbleList</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">RenderData</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;({})</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> agentChatContext</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> useDeferred</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">__VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">AgentChatContext</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;()</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> bubbleItems</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> computed</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(() </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> agentChatContext.value?.simplicity.items.value </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">??</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> []</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 获取指定索引的气泡数据</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> getBubbleDataAt</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">index</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> number</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> bubble</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> bubbleItems.value.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">at</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(index)</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (bubble?.key </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">&amp;&amp;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> bubbleData.value[bubble.key]) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> bubbleData.value[bubble.key]</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {}</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 获取最后一个气泡数据</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> lastBubbleData</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> computed</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(() </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> getBubbleDataAt</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 查找当前正在播报的气泡</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> currentBroadcasting</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> computed</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(() </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> Object.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">values</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(bubbleData.value).</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">find</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">bubble</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> bubble.meta?.broadcasting </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">===</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> true</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 根据播报状态获取背景状态</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> currentMetahumanStatus</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> computed</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(() </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">!</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">currentBroadcasting.value) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> MetahumanStatus.</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">SILENT</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> currentBroadcasting.value?.meta?.metahumanStatus </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">??</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> MetahumanStatus.</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">SPEAKING</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">/* 添加开场白 */</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">agentChatContext.promise.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">then</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(({ </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">chat</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> }) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  chat.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">setMessages</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">([{</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    id: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;prologue&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    message: {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      role: Role.Broadcasting,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      content: prologue.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">split</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">\n</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">||</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> prologue,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      seviceEnd: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      meta: {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        metahumanStatus: MetahumanStatus.</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">WELCOME</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    },</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    status: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;success&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }])</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">/* 语音输入输出功能 */</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 文本转语音函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> textToSpeechFn</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">text</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> string</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> textToSpeech</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    application_id: applicationId,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    text,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }).</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">then</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">blob</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> url</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> URL</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">createObjectURL</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(blob)</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> url</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  })</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// 语音转文本函数</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> speechToTextFn</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">blob</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> file</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> new</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> File</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">([blob], </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;audio.wav&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, {</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    type: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&#39;audio/wav&#39;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  })</span></span>
<span class="line"><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> speechToText</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    application_id: applicationId,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    file,</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }).</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">then</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">res</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =&gt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> res.data)</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">script</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">div</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> h-full</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> w-full</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> pos-relative</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    &lt;!-- 聊天代理提供者 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkAgentChatProvider</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      v-if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;ready&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      :request</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;request&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      :parser</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;parser&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      @load</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;agentChatContext.resolve&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    &gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      &lt;!-- 独立聊天组件 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkChatIndependent</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        class</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;home-chat-independent&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        :data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;bubbleData&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        :speech-to-text</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;stt_model_enable</span></span>
<span class="line"><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">          ? speechToTextFn</span></span>
<span class="line"><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">          : undefined&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        :text-to-speech</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;textToSpeechFn&quot;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">        @set-data</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;setData(bubbleData, $event)&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      &gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">        &lt;!-- 自定义背景 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> #</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">background</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">          &lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">MetahumanBackground</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">            :status</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">=</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;currentMetahumanStatus&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">          &gt;&lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">MetahumanBackground</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">        &lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      &lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkChatIndependent</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    &lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">VkAgentChatProvider</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  &lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">div</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">template</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">style</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">.home-chat-independent</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  overflow</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">hidden</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">.home-chat-independent</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> .vk-chat-independent-main__duplex</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  padding-top</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">40</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">vh</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">.home-chat-independent</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> .el-bubble-list</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> &gt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> .el-bubble:last-child</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  margin-bottom</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">40</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">px</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">.home-chat-independent</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> .vk-chat-independent-main__bubbles</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  mask-image</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">linear-gradient</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">to</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> bottom</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    rgba</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0.4</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">),</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    rgba</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">80</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">%</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    rgba</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">100</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">%</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  );</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;/</span><span style="--shiki-dark:#85E89D;--shiki-light:#22863A;">style</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&gt;</span></span></code></pre></div><h3 id="关键功能解析" tabindex="-1">关键功能解析 <a class="header-anchor" href="#关键功能解析" aria-label="Permalink to &quot;关键功能解析&quot;">​</a></h3><ol><li><p><strong>初始化</strong></p><ul><li>通过 <code>useRequest()</code> 获取请求处理函数</li><li>使用 <code>useDeferred</code> 解决组件加载顺序问题</li></ul></li><li><p><strong>数据处理</strong></p><ul><li>通过计算属性监听气泡数据和状态变化</li><li>设置聊天开场白</li></ul></li><li><p><strong>多模态交互</strong></p><ul><li>实现文本转语音和语音转文本功能</li><li>根据播报状态控制背景表现</li></ul></li><li><p><strong>组件结构</strong></p><ul><li>使用 VkAgentChatProvider 提供聊天代理能力</li><li>嵌套 VkChatIndependent 处理聊天界面和交互</li><li>通过插槽自定义背景组件</li></ul></li></ol></div><!--]--></div><div class="doc-toc-container"><div class="VPDocAsideOutline has-outline" role="navigation" data-v-538be1fa><div class="content" data-v-538be1fa><nav aria-labelledby="doc-outline-aria-label" data-v-538be1fa><span id="doc-outline-aria-label" class="visually-hidden" data-v-538be1fa> Table of Contents for current page </span><!--[--><div class="vp-doc-outline-x" data-v-538be1fa><ul class="VPDocOutlineItem toc-items root" data-v-538be1fa data-v-d3f5820b><!--[--><!--]--></ul><!----></div><!--]--></nav></div></div></div></div></main><!--]--></div></div><!--[--><div class="el-scrollbar__bar is-horizontal" style="display:none;"><div class="el-scrollbar__thumb" style="width:;transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical" style="display:none;"><div class="el-scrollbar__thumb" style="height:;transform:translateY(0%);"></div></div><!--]--></div><!--]--></div></div></div><!--]--></div></div></div>
        <div id="teleported"></div>
        <script id="vike_pageContext" type="application/json">{"fromHtmlRenderer":{},"crowdin":{"pages/component.json":{"lang":"zh-CN","path":"pages/component.json","basename":"component.json","source":{"element":{"text":"Element","children":[{"link":"/tables-v1","text":"TablesV1"},{"link":"/tables-v1-checkbox","text":"TablesV1Checkbox"},{"link":"/table-columns","text":"TableColumns"},{"link":"/routes-menu-content","text":"RoutesMenuContent"},{"link":"/avatar","text":"Avatar"}]},"markdown":{"text":"Markdown","children":[{"link":"/typing-markdown","text":"TypingMarkdown"},{"link":"/broadcasting-markdown","text":"BroadcastingMarkdown"}]},"lottie":{"text":"Lottie","children":[{"link":"/lottie-animation","text":"LottieAnimation"}]},"monaco":{"text":"Monaco","children":[{"link":"/monaco-editor","text":"MonacoEditor"}]},"vditor":{"text":"Vditor","children":[{"link":"/vditor","text":"Vditor"}]},"antx":{"text":"X","children":[{"link":"/sender","text":"Sender"},{"link":"/speech-button","text":"SpeechButton"},{"link":"/recorder-button","text":"RecorderButton"},{"link":"/bubble-list","text":"BubbleList"},{"link":"/agent-chat-provider","text":"AgentChatProvider"},{"link":"/chat-independent","text":"ChatIndependent"}]},"pixi":{"text":"Pixi","children":[{"link":"/pixi-frame","text":"PixiFrame"}]}}},"pages/guide.json":{"lang":"zh-CN","path":"pages/guide.json","basename":"guide.json","source":{"start":{"text":"Start 开始","children":[{"link":"/introduction","text":"Introduction 介绍"}]},"changelog":{"text":"Changelog 更新日志","link":"/changelog"}}},"pages/nav.json":{"lang":"zh-CN","path":"pages/nav.json","basename":"nav.json","source":[{"label":"指南","value":"guide","path":"guide","redirect":"guide/introduction"},{"label":"组件","value":"component","path":"component","redirect":"component/tables-v1"}]}},"_urlRewrite":null,"pageId":"/pages/zh-CN/component/agent-chat-provider","routeParams":{}}</script>
        <script src="/vunk-plus/assets/entries/entry-client-routing.B8g99j8L.js" type="module" async></script>
        <link rel="modulepreload" href="/vunk-plus/assets/entries/pages_zh-CN_component_agent-chat-provider.BiIW8qwv.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/vunk-plus/assets/chunks/chunk-Cl7Gad5t.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/vunk-plus/assets/chunks/chunk-Db8R8jrI.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/vunk-plus/assets/chunks/chunk-C_r11Npf.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/vunk-plus/assets/chunks/chunk-DHDIjX10.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/vunk-plus/assets/chunks/chunk-Dd5JMos_.js" as="script" type="text/javascript">
      </body>
    </html>